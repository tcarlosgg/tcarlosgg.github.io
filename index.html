<!DOCTYPE html>
<html>
<head>
    <title>Maniobras de cruzado</title>
    <script src="Maniobras.js"></script>
    <style>
        .smallText      {color:#696969; font-size:10pt; margin-bottom: -15px}
        .sideNumber     {text-align: center; background-color: rgb(255, 252, 155)}
        .slot           {text-align:center; outline:double 6px black; min-width:400px; background-color: white;}
        .cardContainer  {display:none; grid-template-columns:auto auto auto; padding:20px; text-align:left;}
        .manName        {grid-column:1/span 3; text-align:center; background-color:rgb(229,229,229)}
        .drawButton     {background-color: rgb(255, 252, 155); width:fit-content; height:fit-content; color:#776911; border-width:3px; border-color: #776911; padding: 10px 5px; font-weight:bold;}
        .discardButton  {background-color: rgb(255, 100, 100); color:white; justify-self:right; border-radius:100%; border-width:3px; border-color: #771111; padding:5px 10px; grid-column-start:3; width:fit-content; font-weight:bold;}
        .backgroundDisc {height:100%; width:100%; background-image:url(''); background-size:contain; background-repeat:no-repeat; background-position-x:center; filter:brightness(0.9)}
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=0.1">
</head>
<body style="background-color: #afafaf;">
    
    <div style="display:grid">
        
        <div style="display:grid; grid-template-columns:8% auto 8%">
            <div class="sideNumber">
                <h3>Mazo:</h3>
                <h1 id="pilaRobar">0</h1>
            </div>
            
            <div style="min-width:100%; display:grid; grid-template-columns: 50% 50%; column-gap:20px; grid-template-rows: auto auto auto; row-gap:50px; justify-items:center; margin-top:50px">
                <div id="slot0" class="slot">
                    <div id="card0" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>

                        <button id="discardButton" class="discardButton" onclick="discardCard(0)">X</button>
                    </div>
                    
                    <button id="drawButton0" class="drawButton" onclick="drawCard(0);">ROBAR MANIOBRA</button>
                </div>
                <div id="slot1" class="slot">
                    <div id="card1" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>
                        <button id="discardButton" class="discardButton" onclick="discardCard(1)">X</button>
                    </div>
                    
                    <button id="drawButton1" class="drawButton" onclick="drawCard(1);">ROBAR MANIOBRA</button>
                </div>
                <div id="slot2" class="slot">
                    <div id="card2" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>
                        <button id="discardButton" class="discardButton" onclick="discardCard(2)">X</button>
                    </div>
                    
                    <button id="drawButton2" class="drawButton" onclick="drawCard(2);">ROBAR MANIOBRA</button>
                </div>
                <div id="slot3" class="slot">
                    <div id="card3" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>
                        <button id="discardButton" class="discardButton" onclick="discardCard(3)">X</button>
                    </div>
                    
                    <button id="drawButton3" class="drawButton" onclick="drawCard(3);">ROBAR MANIOBRA</button>
                </div>
                <div id="slot4" class="slot">
                    <div id="card4" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>
                        <button id="discardButton" class="discardButton" onclick="discardCard(4)">X</button>
                    </div>
                    
                    <button id="drawButton4" class="drawButton" onclick="drawCard(4);">ROBAR MANIOBRA</button>
                </div>
                <div id="slot5" class="slot">
                    <div id="card5" class="cardContainer">
                        <h1 id="manName" class="manName">Nombre maniobra</h1>
                        <div style="grid-column:1/span 2; display:flex">
                            <img id="manImg" style="width:64px; height:64px" src="images/test.png">
                            <h2 id="manType" style="margin-left:10px">Tipo</h2>
                        </div>
                        
                        <div class="dataSlice" style="margin-right:-20px">
                            <p class="smallText" style="text-align:center">Nivel:</p>
                            <h2 id="manLevel" style="text-align:center;">0</h2>
                        </div>
                        <div style="grid-column:1/span 3; display:grid; grid-template-columns: 30% 70%">
                            <div style="display:grid; grid-template-rows: auto auto auto auto auto;">
                                <div class="dataSlice">
                                    <p class="smallText">Acción:</p>
                                    <p id="manAccion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Alcance:</p>
                                    <p id="manAlcance">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Objetivo:</p>
                                    <p id="manObjetivo">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Duración:</p>
                                    <p id="manDuracion">Ejemplo</p>
                                </div>
                                <div class="dataSlice">
                                    <p class="smallText">Condición:</p>
                                    <p id="manCondicion">Ejemplo</p>
                                </div>
                            </div>
                            <div id="manDisc" class="backgroundDisc"><p id="manDesc">Descripción</p></div>
                        </div>
                        <button id="discardButton" class="discardButton" onclick="discardCard(5)">X</button>
                    </div>
                    
                    <button id="drawButton5" class="drawButton" onclick="drawCard(5);">ROBAR MANIOBRA</button>
                </div>
                
            </div>
            
            <div class="sideNumber" style="grid-column-start: 3; color: #771111">
                <h3>Descartes:</h3>
                <h1 id="pilaDescartes">0</h1>
            </div>
        </div>
        
        
    </div>
    
    
    <script>
        var drawPile = [];
        var handPile = new Array(6);
        var discardPile = [];
        
        for (let i = 0; i < maniobras.length; i++){
            drawPile.push(i);
        }
        shuffle(drawPile);
        updateUI();
        
        
        
        function drawCard(slotId){
            if(drawPile.length == 0){
                if(discardPile.length > 0){
                    for (let i = discardPile.length-1; i >= 0; i--) {
                        drawPile.push(discardPile.pop());
                        alert("drawPile: "+ drawPile +"\ndiscardPile: "+ discardPile);
                    }
                    shuffle(drawPile);
                    alert(drawPile);
                    drawCard(slotId);
                }
            }
            else {
                var maneuverId = drawPile.pop();
                handPile[slotId] = maneuverId;
                updateUI();
                fillCardData(slotId, maneuverId);
            }
        }
        
        function discardCard(slotId){
            discardPile.push(handPile[slotId]);
            handPile[slotId] = null;

            document.getElementById("card"+ slotId).style.display="none";
            document.getElementById("drawButton"+ slotId).style.display="initial";
            updateUI();
        }
        
        function shuffle(deck){
            for (let i = deck.length - 1; i>0; i--){
                let j = Math.floor(Math.random() * (i+1));
                
                let temp = deck[i];
                deck[i] = deck[j];
                deck[j] = temp;
            }
        }
        
        function updateUI(){
            document.getElementById("pilaRobar").textContent=drawPile.length;
            document.getElementById("pilaDescartes").textContent=discardPile.length;
        }
        
        function fillCardData(slot, maneuver){
            var cardSlot = "card"+ slot;
            document.querySelector("#card"+ slot +" #manName").textContent=maniobras[maneuver].nombre;

            switch (maniobras[maneuver].disciplina){
                case "devo": document.querySelector("#card"+ slot +" #manDisc").style.backgroundImage="url('images/dis_devoutSpirit.png')";
                break;
                case "drag": document.querySelector("#card"+ slot +" #manDisc").style.backgroundImage="url('images/dis_stoneDragon.png')";
                break;
                case "cuer": document.querySelector("#card"+ slot +" #manDisc").style.backgroundImage="url('images/dis_whiteRaven.png')";
                break;
                default: document.querySelector("#card"+ slot +" #manDisc").style.backgroundImage="url('images/error.gif')";
                break;
            }

            if (maniobras[maneuver].subtipo == ""){  //Si tiene subtipo, se le pone. Si no, solo cambiamos el tipo.
                document.querySelector("#card"+ slot +" #manType").textContent=maniobras[maneuver].tipo;
            } else {
                document.querySelector("#card"+ slot +" #manType").textContent=maniobras[maneuver].tipo +" ["+ maniobras[maneuver].subtipo +"]";
            }
            switch (maniobras[maneuver].tipo){
                case "Golpe": document.querySelector("#card"+ slot +" #manImg").src="images/type_Strike.png";
                break;
                case "Impulso": document.querySelector("#card"+ slot +" #manImg").src="images/type_Boost.png";
                break;
                case "Contraataque": document.querySelector("#card"+ slot +" #manImg").src="images/type_Counter.png";
                break;
                default: document.querySelector("#card"+ slot +" #manImg").src="images/error.gif";
                break;
            }
            
            document.querySelector("#card"+ slot +" #manLevel").textContent=maniobras[maneuver].nivel;
            document.querySelector("#card"+ slot +" #manAccion").textContent=maniobras[maneuver].accion;
            document.querySelector("#card"+ slot +" #manAlcance").textContent=maniobras[maneuver].alcance;
            document.querySelector("#card"+ slot +" #manObjetivo").textContent=maniobras[maneuver].objetivo;
            document.querySelector("#card"+ slot +" #manDuracion").textContent=maniobras[maneuver].duracion;
            document.querySelector("#card"+ slot +" #manCondicion").textContent=maniobras[maneuver].condicion;
            document.querySelector("#card"+ slot +" #manDesc").textContent=maniobras[maneuver].descripcion;
            
            document.getElementById("drawButton"+ slot).style.display="none";
            document.getElementById("card"+ slot).style.display="grid";
            
        }
        
    </script>
</body>
</html>